
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Training and inference on your own data using Google Drive &#8212; SLEAP (v1.2.1)</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=84ace793992934648b4de8eed757e5a2" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.9d8b4a8b9bb19db25eeaddc40d639ba2.js"></script>
    <link rel="canonical" href="/develop/notebooks/Training_and_inference_using_Google_Drive.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Model evaluation" href="Model_evaluation.html" />
    <link rel="prev" title="Training and inference on an example dataset" href="Training_and_inference_on_an_example_dataset.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<div class="col-12 col-md-3 bd-sidebar site-navigation " id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">SLEAP (v1.2.1)</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Home
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tutorials/tutorial.html">
   Tutorial
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/new-project.html">
     Creating a project
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/initial-labeling.html">
     Initial Labeling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/initial-training.html">
     Training and Inference
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/assisted-labeling.html">
     Prediction-assisted labeling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/proofreading.html">
     Tracking instances across frames
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/analysis.html">
     Export Data For Analysis
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../guides/index.html">
   Guides
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../guides/gui.html">
     GUI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guides/cli.html">
     Command line interfaces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guides/skeletons.html">
     Skeleton design
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guides/choosing-models.html">
     Choosing a set of models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guides/merging.html">
     Importing predictions for labeling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guides/proofreading.html">
     Tracking and proofreading
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guides/colab.html">
     Run training and inference on Colab
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guides/custom-training.html">
     Creating a custom training profile
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guides/remote.html">
     Running SLEAP remotely
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Notebooks
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="Training_and_inference_on_an_example_dataset.html">
     Training and inference on an example dataset
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Training and inference on your own data using Google Drive
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Model_evaluation.html">
     Model evaluation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Analysis_examples.html">
     Analysis examples
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../api.html">
   Developer API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.instance.html">
     sleap.instance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.message.html">
     sleap.message
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.skeleton.html">
     sleap.skeleton
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.util.html">
     sleap.util
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.callbacks.html">
     sleap.nn.callbacks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.evals.html">
     sleap.nn.evals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.heads.html">
     sleap.nn.heads
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.identity.html">
     sleap.nn.identity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.inference.html">
     sleap.nn.inference
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.losses.html">
     sleap.nn.losses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.model.html">
     sleap.nn.model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.monitor.html">
     sleap.nn.monitor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.paf_grouping.html">
     sleap.nn.paf_grouping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.peak_finding.html">
     sleap.nn.peak_finding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.system.html">
     sleap.nn.system
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.tracking.html">
     sleap.nn.tracking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.training.html">
     sleap.nn.training
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.utils.html">
     sleap.nn.utils
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.viz.html">
     sleap.nn.viz
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.config.data.html">
     sleap.nn.config.data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.config.model.html">
     sleap.nn.config.model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.config.optimization.html">
     sleap.nn.config.optimization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.config.outputs.html">
     sleap.nn.config.outputs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.config.training_job.html">
     sleap.nn.config.training_job
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.config.utils.html">
     sleap.nn.config.utils
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.augmentation.html">
     sleap.nn.data.augmentation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.confidence_maps.html">
     sleap.nn.data.confidence_maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.dataset_ops.html">
     sleap.nn.data.dataset_ops
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.edge_maps.html">
     sleap.nn.data.edge_maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.general.html">
     sleap.nn.data.general
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.grouping.html">
     sleap.nn.data.grouping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.identity.html">
     sleap.nn.data.identity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.inference.html">
     sleap.nn.data.inference
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.instance_centroids.html">
     sleap.nn.data.instance_centroids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.instance_cropping.html">
     sleap.nn.data.instance_cropping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.normalization.html">
     sleap.nn.data.normalization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.offset_regression.html">
     sleap.nn.data.offset_regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.pipelines.html">
     sleap.nn.data.pipelines
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.providers.html">
     sleap.nn.data.providers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.resizing.html">
     sleap.nn.data.resizing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.training.html">
     sleap.nn.data.training
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.utils.html">
     sleap.nn.data.utils
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.tracker.components.html">
     sleap.nn.tracker.components
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.tracker.kalman.html">
     sleap.nn.tracker.kalman
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.architectures.common.html">
     sleap.nn.architectures.common
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.architectures.encoder_decoder.html">
     sleap.nn.architectures.encoder_decoder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.architectures.hourglass.html">
     sleap.nn.architectures.hourglass
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.architectures.hrnet.html">
     sleap.nn.architectures.hrnet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.architectures.leap.html">
     sleap.nn.architectures.leap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.architectures.pretrained_encoders.html">
     sleap.nn.architectures.pretrained_encoders
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.architectures.resnet.html">
     sleap.nn.architectures.resnet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.architectures.unet.html">
     sleap.nn.architectures.unet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.architectures.upsampling.html">
     sleap.nn.architectures.upsampling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.asyncvideo.html">
     sleap.io.asyncvideo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.convert.html">
     sleap.io.convert
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.dataset.html">
     sleap.io.dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.legacy.html">
     sleap.io.legacy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.pathutils.html">
     sleap.io.pathutils
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.video.html">
     sleap.io.video
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.videowriter.html">
     sleap.io.videowriter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.visuals.html">
     sleap.io.visuals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.adaptor.html">
     sleap.io.format.adaptor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.coco.html">
     sleap.io.format.coco
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.deeplabcut.html">
     sleap.io.format.deeplabcut
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.deepposekit.html">
     sleap.io.format.deepposekit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.dispatch.html">
     sleap.io.format.dispatch
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.filehandle.html">
     sleap.io.format.filehandle
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.genericjson.html">
     sleap.io.format.genericjson
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.hdf5.html">
     sleap.io.format.hdf5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.labels_json.html">
     sleap.io.format.labels_json
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.leap_matlab.html">
     sleap.io.format.leap_matlab
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.main.html">
     sleap.io.format.main
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.sleap_analysis.html">
     sleap.io.format.sleap_analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.text.html">
     sleap.io.format.text
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.info.align.html">
     sleap.info.align
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.info.feature_suggestions.html">
     sleap.info.feature_suggestions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.info.labels.html">
     sleap.info.labels
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.info.metrics.html">
     sleap.info.metrics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.info.summary.html">
     sleap.info.summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.info.trackcleaner.html">
     sleap.info.trackcleaner
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.info.write_tracking_h5.html">
     sleap.info.write_tracking_h5
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/murthylab/sleap-datasets">
   Sample datasets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/murthylab/sleap">
   Source code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/murthylab/sleap/releases">
   Releases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../help.html">
   Help
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

</div>


          


          
<!-- This is an invisible pixel that we watch to see if we've scrolled. -->
<div class="sbt-scroll-pixel-helper"></div>
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            <div class="topbar-left">
                
                <label class="nav-toggle-button" for="__navigation">
                    <div class="visually-hidden">Toggle navigation</div>
                    <i class="fas fa-bars"></i>
                </label>
                
            </div>
            
            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/murthylab/sleap"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/murthylab/sleap/issues/new?title=Issue%20on%20page%20%2Fnotebooks/Training_and_inference_using_Google_Drive.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#install-sleap">
   Install SLEAP
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-training-data-into-colab-with-google-drive">
   Import training data into Colab with Google Drive
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-and-export-the-training-job-package">
     Create and export the training job package
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#upload-training-job-package-to-google-drive">
     Upload training job package to Google Drive
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mount-your-google-drive">
     Mount your Google Drive
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#train-a-model">
   Train a model
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#note-on-training-profiles">
     Note on training profiles
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#note-on-training-process">
     Note on training process
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-inference-to-predict-instances">
   Run inference to predict instances
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#predicting-instances-in-suggested-frames">
     Predicting instances in suggested frames
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#predicting-and-tracking-instances-in-uploaded-video">
     Predicting and tracking instances in uploaded video
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inference-with-top-down-models">
     Inference with top-down models
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Training and inference on your own data using Google Drive</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#install-sleap">
   Install SLEAP
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-training-data-into-colab-with-google-drive">
   Import training data into Colab with Google Drive
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-and-export-the-training-job-package">
     Create and export the training job package
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#upload-training-job-package-to-google-drive">
     Upload training job package to Google Drive
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mount-your-google-drive">
     Mount your Google Drive
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#train-a-model">
   Train a model
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#note-on-training-profiles">
     Note on training profiles
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#note-on-training-process">
     Note on training process
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-inference-to-predict-instances">
   Run inference to predict instances
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#predicting-instances-in-suggested-frames">
     Predicting instances in suggested frames
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#predicting-and-tracking-instances-in-uploaded-video">
     Predicting and tracking instances in uploaded video
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inference-with-top-down-models">
     Inference with top-down models
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <p><a href="https://colab.research.google.com/github/murthylab/sleap/blob/main/docs/notebooks/Training_and_inference_using_Google_Drive.ipynb" target="_parent"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<div class="tex2jax_ignore mathjax_ignore section" id="training-and-inference-on-your-own-data-using-google-drive">
<h1>Training and inference on your own data using Google Drive<a class="headerlink" href="#training-and-inference-on-your-own-data-using-google-drive" title="Permalink to this headline">¶</a></h1>
<p>In this notebook we’ll install SLEAP, import training data into Colab using <a class="reference external" href="https://www.google.com/drive">Google Drive</a>, and run training and inference.</p>
<div class="section" id="install-sleap">
<h2>Install SLEAP<a class="headerlink" href="#install-sleap" title="Permalink to this headline">¶</a></h2>
<p>Note: Before installing SLEAP check <a class="reference external" href="https://github.com/murthylab/sleap/releases">SLEAP releases</a> page for the latest version.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip uninstall -y opencv-python opencv-contrib-python
<span class="o">!</span>pip install sleap
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="import-training-data-into-colab-with-google-drive">
<h2>Import training data into Colab with Google Drive<a class="headerlink" href="#import-training-data-into-colab-with-google-drive" title="Permalink to this headline">¶</a></h2>
<p>We’ll first prepare and export the training data from SLEAP, then upload it to Google Drive, and then mount Google Drive  into this Colab notebook.</p>
<div class="section" id="create-and-export-the-training-job-package">
<h3>Create and export the training job package<a class="headerlink" href="#create-and-export-the-training-job-package" title="Permalink to this headline">¶</a></h3>
<p>A self-contained <strong>training job package</strong> contains a .slp file with labeled data and images which will be used for training, as well as .json training configuration file(s).</p>
<p>A training job package can be exported in the SLEAP GUI fron the “Run Training…” dialog under the “Predict” menu.</p>
</div>
<div class="section" id="upload-training-job-package-to-google-drive">
<h3>Upload training job package to Google Drive<a class="headerlink" href="#upload-training-job-package-to-google-drive" title="Permalink to this headline">¶</a></h3>
<p>To be consistent with the examples in this notebook, name the SLEAP project <code class="docutils literal notranslate"><span class="pre">colab</span></code> and create a directory called <code class="docutils literal notranslate"><span class="pre">sleap</span></code> in the root of your Google Drive. Then upload the exported training job package <code class="docutils literal notranslate"><span class="pre">colab.slp.training_job.zip</span></code> into <code class="docutils literal notranslate"><span class="pre">sleap</span></code> directory.</p>
<p>If you place your training pckage somewhere else, or name it differently, adjust the paths/filenames/parameters below accordingly.</p>
</div>
<div class="section" id="mount-your-google-drive">
<h3>Mount your Google Drive<a class="headerlink" href="#mount-your-google-drive" title="Permalink to this headline">¶</a></h3>
<p>Mounting your Google Drive will allow you to accessed the uploaded training job package in this notebook. When prompted to log into your Google account, give Colab access and the copy the authorization code into a field below (+ hit ‘return’).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive/&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mounted at /content/drive/
</pre></div>
</div>
</div>
</div>
<p>Let’s set your current working directory to the directory with your training job package and unpack it there. Later on the output from training (i.e., the models) and from interence (i.e., predictions) will all be saved in this directory as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s2">&quot;/content/drive/My Drive/sleap&quot;</span><span class="p">)</span>
<span class="o">!</span>unzip colab.slp.training_job.zip
<span class="o">!</span>ls
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="train-a-model">
<h2>Train a model<a class="headerlink" href="#train-a-model" title="Permalink to this headline">¶</a></h2>
<p>Let’s train a model with the training profile (.json file) and the project data (.slp file) you have exported from SLEAP.</p>
<div class="section" id="note-on-training-profiles">
<h3>Note on training profiles<a class="headerlink" href="#note-on-training-profiles" title="Permalink to this headline">¶</a></h3>
<p>Depending on the pipeline you chose in the training dialog, the config filename(s) will be:</p>
<ul class="simple">
<li><p>for a <strong>bottom-up</strong> pipeline approach: <code class="docutils literal notranslate"><span class="pre">multi_instance.json</span></code> (this is the pipeline we assume here),</p></li>
<li><p>for a <strong>top-down</strong> pipeline, you’ll have a different profile for each of the models: <code class="docutils literal notranslate"><span class="pre">centroid.json</span></code> and <code class="docutils literal notranslate"><span class="pre">centered_instance.json</span></code>,</p></li>
<li><p>for a <strong>single animal</strong> pipeline: <code class="docutils literal notranslate"><span class="pre">single_instance.json</span></code>.</p></li>
</ul>
</div>
<div class="section" id="note-on-training-process">
<h3>Note on training process<a class="headerlink" href="#note-on-training-process" title="Permalink to this headline">¶</a></h3>
<p>When you start training, you’ll first see the training parameters and then the training and validation loss for each training epoch.</p>
<p>As soon as you’re satisfied with the validation loss you see for an epoch during training, you’re welcome to stop training by clicking the stop button. The version of the model with the lowest validation loss is saved during training, and that’s what will be used for inference.</p>
<p>If you don’t stop training, it will run for 200 epochs or until validation loss fails to improve for some number of epochs (controlled by the early_stopping fields in the training profile).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>sleap-train multi_instance.json colab.pkg.slp
</pre></div>
</div>
</div>
</div>
<p>If instead of bottom-up you’ve chosen the top-down pipeline (with two training configs), you would need to invoke two separate training jobs in sequence:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">!sleap-train</span> <span class="pre">centroid.json</span> <span class="pre">colab.pkg.slp</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">!sleap-train</span> <span class="pre">centered_instance.json</span> <span class="pre">colab.pkg.slp</span></code></p></li>
</ul>
</div>
</div>
<div class="section" id="run-inference-to-predict-instances">
<h2>Run inference to predict instances<a class="headerlink" href="#run-inference-to-predict-instances" title="Permalink to this headline">¶</a></h2>
<p>Once training finishes, you’ll see a new directory (or two new directories for top-down training pipeline) containing all the model files SLEAP needs to use for inference.</p>
<p>Here we’ll use the created model files to run inference in two modes:</p>
<ul class="simple">
<li><p>predicting instances in suggested frames from the exported .slp file</p></li>
<li><p>predicting and tracking instances in uploaded video</p></li>
</ul>
<p>You can also download the trained models for running inference from the SLEAP GUI on your computer (or anywhere else).</p>
<div class="section" id="predicting-instances-in-suggested-frames">
<h3>Predicting instances in suggested frames<a class="headerlink" href="#predicting-instances-in-suggested-frames" title="Permalink to this headline">¶</a></h3>
<p>This mode of predicting instances is useful for accelerating the manual labeling work; it allows you to get early predictions on suggested frames and merge them back into the project for faster labeling.</p>
<p>Here we assume you’ve trained a bottom-up model and that the model files were written in directory named <code class="docutils literal notranslate"><span class="pre">colab_demo.bottomup</span></code>; later in this notebook we’ll also show how to run inference with the pair of top-down models instead.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>!sleap-track \
    -m colab_demo.bottomup \
    --only-suggested-frames \
    -o colab.predicted_suggestions.slp \
    colab.pkg.slp
</pre></div>
</div>
</div>
</div>
<p>Now, you can download the generated <code class="docutils literal notranslate"><span class="pre">colab.predicted_suggestions.slp</span></code> file and merge it into your labeling project (<strong>File -&gt; Merge into Project…</strong> from the GUI) to get new predictions for your suggested frames.</p>
</div>
<div class="section" id="predicting-and-tracking-instances-in-uploaded-video">
<h3>Predicting and tracking instances in uploaded video<a class="headerlink" href="#predicting-and-tracking-instances-in-uploaded-video" title="Permalink to this headline">¶</a></h3>
<p>Let’s first upload the video we want to run inference on and name it <code class="docutils literal notranslate"><span class="pre">colab_demo.mp4</span></code>. (If your video is not named <code class="docutils literal notranslate"><span class="pre">colab_demo.mp4</span></code>, adjust the names below accordingly.)</p>
<p>For this demo we’ll just get predictions for the first 200 frames (or you can adjust the –frames parameter below or remove it to run on the whole video).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>!sleap-track colab_demo.mp4 \
    --frames 0-200 \
    --tracking.tracker simple \
    -m colab_demo.bottomup
</pre></div>
</div>
</div>
</div>
<p>When inference is finished, it will save the predictions in a file which can be opened in the GUI as a SLEAP project file. The file will be in the same directory as the video and the filename will be <code class="docutils literal notranslate"><span class="pre">{video</span> <span class="pre">filename}.predictions.slp</span></code>.</p>
<p>Let’s inspect the predictions file:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>sleap-inspect colab_demo.mp4.predictions.slp
</pre></div>
</div>
</div>
</div>
<p>You can copy this file from your Google Drive to a local drive and open it in the SLEAP GUI app (or open it directly if you have your Google Drive mounted on your local machine). If the video is in the same directory as the predictions file, SLEAP will automatically find it; otherwise, you’ll be prompted to locate the video (since the path to the video on your local machine will be different than the path to the video on Colab).</p>
</div>
<div class="section" id="inference-with-top-down-models">
<h3>Inference with top-down models<a class="headerlink" href="#inference-with-top-down-models" title="Permalink to this headline">¶</a></h3>
<p>If you trained the pair of models needed for top-down inference, you can call <code class="docutils literal notranslate"><span class="pre">sleap-track</span></code> with <code class="docutils literal notranslate"><span class="pre">-m</span> <span class="pre">path/to/model</span></code> for each model, like so:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>!sleap-track colab_demo.mp4 \
    --frames 0-200 \
    --tracking.tracker simple \
    -m colab_demo.centered_instance \
    -m colab_demo.centroid
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>


              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="Training_and_inference_on_an_example_dataset.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Training and inference on an example dataset</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Model_evaluation.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Model evaluation</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Talmo D. Pereira<br/>
    
        &copy; Copyright 2019–2022, Talmo Lab.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>