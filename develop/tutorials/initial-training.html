
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Training and Inference &#8212; SLEAP (v1.2.0)</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=84ace793992934648b4de8eed757e5a2" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.9d8b4a8b9bb19db25eeaddc40d639ba2.js"></script>
    <link rel="canonical" href="/develop/tutorials/initial-training.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Prediction-assisted labeling" href="assisted-labeling.html" />
    <link rel="prev" title="Initial Labeling" href="initial-labeling.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<div class="col-12 col-md-3 bd-sidebar site-navigation " id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">SLEAP (v1.2.0)</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Home
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="tutorial.html">
   Tutorial
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="new-project.html">
     Creating a project
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="initial-labeling.html">
     Initial Labeling
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Training and Inference
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="assisted-labeling.html">
     Prediction-assisted labeling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="proofreading.html">
     Tracking instances across frames
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="analysis.html">
     Export Data For Analysis
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../guides/index.html">
   Guides
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../guides/gui.html">
     GUI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guides/cli.html">
     Command line interfaces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guides/skeletons.html">
     Skeleton design
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guides/choosing-models.html">
     Choosing a set of models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guides/merging.html">
     Importing predictions for labeling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guides/proofreading.html">
     Tracking and proofreading
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guides/colab.html">
     Run training and inference on Colab
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guides/custom-training.html">
     Creating a custom training profile
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../guides/remote.html">
     Running SLEAP remotely
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../notebooks/index.html">
   Notebooks
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../notebooks/Training_and_inference_on_an_example_dataset.html">
     Training and inference on an example dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../notebooks/Training_and_inference_using_Google_Drive.html">
     Training and inference on your own data using Google Drive
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../notebooks/Model_evaluation.html">
     Model evaluation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../notebooks/Analysis_examples.html">
     Analysis examples
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../api.html">
   Developer API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.instance.html">
     sleap.instance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.message.html">
     sleap.message
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.skeleton.html">
     sleap.skeleton
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.util.html">
     sleap.util
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.callbacks.html">
     sleap.nn.callbacks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.evals.html">
     sleap.nn.evals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.heads.html">
     sleap.nn.heads
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.inference.html">
     sleap.nn.inference
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.losses.html">
     sleap.nn.losses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.model.html">
     sleap.nn.model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.monitor.html">
     sleap.nn.monitor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.paf_grouping.html">
     sleap.nn.paf_grouping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.peak_finding.html">
     sleap.nn.peak_finding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.system.html">
     sleap.nn.system
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.tracking.html">
     sleap.nn.tracking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.training.html">
     sleap.nn.training
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.utils.html">
     sleap.nn.utils
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.viz.html">
     sleap.nn.viz
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.config.data.html">
     sleap.nn.config.data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.config.model.html">
     sleap.nn.config.model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.config.optimization.html">
     sleap.nn.config.optimization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.config.outputs.html">
     sleap.nn.config.outputs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.config.training_job.html">
     sleap.nn.config.training_job
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.config.utils.html">
     sleap.nn.config.utils
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.augmentation.html">
     sleap.nn.data.augmentation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.confidence_maps.html">
     sleap.nn.data.confidence_maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.dataset_ops.html">
     sleap.nn.data.dataset_ops
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.edge_maps.html">
     sleap.nn.data.edge_maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.general.html">
     sleap.nn.data.general
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.grouping.html">
     sleap.nn.data.grouping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.inference.html">
     sleap.nn.data.inference
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.instance_centroids.html">
     sleap.nn.data.instance_centroids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.instance_cropping.html">
     sleap.nn.data.instance_cropping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.normalization.html">
     sleap.nn.data.normalization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.offset_regression.html">
     sleap.nn.data.offset_regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.pipelines.html">
     sleap.nn.data.pipelines
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.providers.html">
     sleap.nn.data.providers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.resizing.html">
     sleap.nn.data.resizing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.training.html">
     sleap.nn.data.training
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.data.utils.html">
     sleap.nn.data.utils
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.tracker.components.html">
     sleap.nn.tracker.components
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.tracker.kalman.html">
     sleap.nn.tracker.kalman
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.architectures.common.html">
     sleap.nn.architectures.common
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.architectures.encoder_decoder.html">
     sleap.nn.architectures.encoder_decoder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.architectures.hourglass.html">
     sleap.nn.architectures.hourglass
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.architectures.hrnet.html">
     sleap.nn.architectures.hrnet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.architectures.leap.html">
     sleap.nn.architectures.leap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.architectures.pretrained_encoders.html">
     sleap.nn.architectures.pretrained_encoders
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.architectures.resnet.html">
     sleap.nn.architectures.resnet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.architectures.unet.html">
     sleap.nn.architectures.unet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.nn.architectures.upsampling.html">
     sleap.nn.architectures.upsampling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.asyncvideo.html">
     sleap.io.asyncvideo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.convert.html">
     sleap.io.convert
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.dataset.html">
     sleap.io.dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.legacy.html">
     sleap.io.legacy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.pathutils.html">
     sleap.io.pathutils
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.video.html">
     sleap.io.video
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.videowriter.html">
     sleap.io.videowriter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.visuals.html">
     sleap.io.visuals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.adaptor.html">
     sleap.io.format.adaptor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.coco.html">
     sleap.io.format.coco
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.deeplabcut.html">
     sleap.io.format.deeplabcut
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.deepposekit.html">
     sleap.io.format.deepposekit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.dispatch.html">
     sleap.io.format.dispatch
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.filehandle.html">
     sleap.io.format.filehandle
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.genericjson.html">
     sleap.io.format.genericjson
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.hdf5.html">
     sleap.io.format.hdf5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.labels_json.html">
     sleap.io.format.labels_json
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.leap_matlab.html">
     sleap.io.format.leap_matlab
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.main.html">
     sleap.io.format.main
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.sleap_analysis.html">
     sleap.io.format.sleap_analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.io.format.text.html">
     sleap.io.format.text
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.info.align.html">
     sleap.info.align
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.info.feature_suggestions.html">
     sleap.info.feature_suggestions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.info.labels.html">
     sleap.info.labels
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.info.metrics.html">
     sleap.info.metrics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.info.summary.html">
     sleap.info.summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.info.trackcleaner.html">
     sleap.info.trackcleaner
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/sleap.info.write_tracking_h5.html">
     sleap.info.write_tracking_h5
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/murthylab/sleap-datasets">
   Sample datasets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/murthylab/sleap">
   Source code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/murthylab/sleap/releases">
   Releases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../help.html">
   Help
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

</div>


          


          
<!-- This is an invisible pixel that we watch to see if we've scrolled. -->
<div class="sbt-scroll-pixel-helper"></div>
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            <div class="topbar-left">
                
                <label class="nav-toggle-button" for="__navigation">
                    <div class="visually-hidden">Toggle navigation</div>
                    <i class="fas fa-bars"></i>
                </label>
                
            </div>
            
            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/murthylab/sleap"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#training-options">
   Training Options
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#start-training">
   Start Training
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inference">
   Inference
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Training and Inference</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#training-options">
   Training Options
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#start-training">
   Start Training
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inference">
   Inference
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="training-and-inference">
<span id="initial-training"></span><h1>Training and Inference<a class="headerlink" href="#training-and-inference" title="Permalink to this headline">¶</a></h1>
<p>After labeling about 10 frames and saving the project you can train your first model and start getting initial predictions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This tutorial assumes you have a GPU in your local machine and that TensorFlow is able to use your GPU. If you don’t have a GPU or you’re having trouble getting it to work, you can run training and inference in the cloud. See our <a class="reference internal" href="../guides/colab.html#colab"><span class="std std-ref">Run training and inference on Colab</span></a> guide! Or take a look at our other <a class="reference internal" href="../guides/index.html#guides"><span class="std std-ref">Guides</span></a> about running SLEAP on remote machines.</p>
</div>
<div class="section" id="training-options">
<span id="id1"></span><h2>Training Options<a class="headerlink" href="#training-options" title="Permalink to this headline">¶</a></h2>
<p>When you’re ready to train you will have three choices for models: <em>single animal</em>, multi-animal <strong>top-down</strong>, or multi-animal <strong>bottom-up</strong>.</p>
<p>In <strong>top-down</strong> mode for multiple animals, a network first finds each animal and then a separate network estimates the pose of each found animal:</p>
<img alt="../_images/topdown_approach.jpg" src="../_images/topdown_approach.jpg" />
<p>In <strong>bottom-up</strong> mode, a network first finds all of the body parts in an image, and then another network groups them into animal instances using part affinity fields (<a class="reference external" href="https://arxiv.org/abs/1611.08050">Cao et al., 2017</a>):</p>
<img alt="../_images/bottomup_approach.jpg" src="../_images/bottomup_approach.jpg" />
<p>We find that top-down mode works better for some multi-animal datasets while bottom-up works better for others - to maximize the accuracy of predictions we recommend you to try both and see which one works best for your dataset.</p>
<p>In addition, SLEAP uses UNET as its default backbone, but you can choose other backbones (LEAP, resnet, etc.) from a drop down menu.</p>
<p>For more information about the types of models you can train, see <a class="reference internal" href="../guides/choosing-models.html#choosing-models"><span class="std std-ref">Choosing a set of models</span></a>.</p>
</div>
<div class="section" id="start-training">
<h2>Start Training<a class="headerlink" href="#start-training" title="Permalink to this headline">¶</a></h2>
<p>To run training on your local machine, select “<strong>Run Training…</strong>” from the “Predict”
menu. For this tutorial, let’s use the default settings for training with the “top-down” pipeline and predict on 20 random frames.</p>
<p><img alt="image6" src="../_images/training-dialog.jpg" /></p>
<p>Recall that the “topdown” approach will train two models: one for locating each instance in the frame, and one for locating the parts for each of those instances. The models will be trained in that order.</p>
<p>When using the topdown approach, it’s a good idea to choose an <strong>anchor</strong> part which has a relatively stable position near the center of your animal. You may also want to turn on the option to “<strong>Visualize Predictions During Training</strong>” (although this will make training run a bit more slowly).</p>
<p>Once you hit the <strong>Run</strong> button, you should see a window which shows you a graph of training and validation loss for each model as it trains. Since the topdown approach trains two models, once you’re done training the centroid model the graph will reset to show you loss while training the centered instance model.</p>
<p>Just for this tutorial, let’s stop each training session after about 10 epochs. This should take a minute or two for each model (assuming you have a usable GPU!), and should be good enough to get some initial predictions.</p>
</div>
<div class="section" id="inference">
<span id="initial-inference"></span><h2>Inference<a class="headerlink" href="#inference" title="Permalink to this headline">¶</a></h2>
<p>After each model is trained, inference will run and if everything is successful, you should get a dialog telling you how many frames got predictions. Frames with labels will be marked in the seekbar, so try clicking on the newly marked frames or use the “<strong>Next Labeled Frame</strong>” command in the “Go” menu to step through frames with labels.</p>
<p>Once you got the initial predictions from the trained models you enter into a human-in-the-loop training cycle, in which you receive predictions and use them to continue to label more examples. You will continue to iterate this process until you have achieved the desired pose labeling accuracy for your dataset. The goal at this stage is to get accurate pose predictions on individual frames. This means that the points for each body part are predicted in the correct locations and that the points are correctly grouped into distinct animal instances.</p>
<p>Continue to <a class="reference internal" href="assisted-labeling.html#assisted-labeling"><span class="std std-ref">Prediction-assisted labeling</span></a>.</p>
</div>
</div>


              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="initial-labeling.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Initial Labeling</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="assisted-labeling.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Prediction-assisted labeling</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Talmo D. Pereira<br/>
    
        &copy; Copyright 2019–2022, Talmo Lab.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>